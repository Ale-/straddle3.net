{# Frontpage #}
{% extends 'layouts/single-fluid-column.html' %}
{% load static utils i18n l10n leaflet_tags imagekit %}
{% block body_classes %}page--project{% endblock %}
{% block page_html_title %}{{ object.name }}{% endblock %}

{% block page_header %}
    {% leaflet_css %}
    <link rel="stylesheet" href='{% static 'flexslider/flexslider.css' %}' />
    <link rel="stylesheet" href='{% static 'lightbox2/dist/css/lightbox.min.css' %}' />
{% endblock %}

{% block main %}

{% if request.user.is_staff %}
<div class="page__edit--project">
    <a href="{% url 'admin:models_project_change' object.id %}" target="_blank">
        {% trans 'Edita este contenido' %}
    </a>
</div>
{% endif %}

<div class="page__content--project">
    <div class="container-fixed">
        <nav class="breadcrumb">
            <a href="{% url 'front' %}">s3</a> » <a href="{% url 'projects' %}">{% trans 'Proyectos' %}</a> » {{ object.name }}
        </nav>
        {# title #}
        <h1 class="page__title--project">
            {{ object.name }}
        </h1>
        {# dates #}
        {% include 'fields/field-date.html' with start=object.start_date end=object.end_date b='project' m='full' %}
        <div class="left">
            <div class="project-full">
                {# summary #}
                {% if not object.not_summary %}
                    {% field obj=object field_name='summary' %}
                {% endif %}
                {# see more #}
                <button class="see-more">
                    {% trans 'Leer más' %}
                </button>
                <button class="see-less">
                    ✕
                </button>
                {# body #}
                {% field obj=object field_name='body' %}
            </div>
        </div>
        <div class="right">
            {% include 'blocks/flexslider.html' with images=object.images.all videos=object.videos.all notcaption=image.notcaption %}
            {% include 'blocks/share.html' %}
        </div>
    </div>
    <div class="page__content-bottom--project">
        <div class="container-fixed">
            <div class="left">
                <h4 class="meta-title">{{ object.name }}</h4>
                {# geolocation #}
                {% include 'fields/field--geolocation.html' with b="project" m="full" %}
            </div>
            <div class="center">
                {# promoter #}
                {% field obj=object field_name='promoter' label=True %}
                {# author_text #}
                {% field obj=object field_name='author_text' label=True %}
                {# gratitude_text #}
                {% field obj=object field_name='gratitude_text' label=True %}
            </div>
            <div class="right">
                {# category #}
                {% include 'fields/field--category.html' with b="project" m="full" category=object.category %}
                {# tags #}
                {% include 'fields/field--tags.html' with b="project" m="full" tags=object.tags.all %}
                {# links #}
                {% include 'fields/field--links.html' with b="project" m="full" links=object.links.all %}
            </div>
        </div>
    </div>
    {% include 'blocks/next-navigation.html' with prev=previous_project next=next_project all_url='projects' see_all='Ver todos los proyectos' %}
</div>
{% endblock %}

{% block page_scripts %}
    {% include 'scripts/situation-map.html' with position=object.geolocation %}
    {% include 'scripts/flexslider.html' %}
{% endblock %}
